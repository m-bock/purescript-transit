## Example 2: Door with Pin

Full source code: _[test/Examples/DoorWithPin.purs](test/Examples/DoorWithPin.purs)_

Now let's add a PIN code to our door lock. This introduces two important concepts: **states with data** and **conditional transitions**.

<picture>
  <source media="(prefers-color-scheme: dark)" srcset="graphs/door-with-pin-dark.svg">
  <source media="(prefers-color-scheme: light)" srcset="graphs/door-with-pin-light.svg">
  <img alt="Door with Pin state diagram" src="graphs/door-with-pin-light.svg">
</picture>

In this example, the `DoorLocked` state stores a PIN code, and the `Unlock` message includes the entered PIN. The unlock operation can succeed (transitioning to `DoorClosed`) or fail (staying in `DoorLocked`), depending on whether the entered PIN matches the stored one.

Notice the diamond node in the state diagram‚Äîthis represents a conditional transition where the outcome depends on runtime data.

The transition table shows both possible outcomes:

<!-- PD_START:raw
filePath: graphs/door-with-pin.html
--><table><caption>Door with Pin</caption><thead><tr><th>From State</th><th /><th>Transition</th><th /><th>To State</th></tr></thead><tbody><tr><td>DoorOpen</td><td>‚ü∂</td><td>Close</td><td>‚ü∂</td><td>DoorClosed</td></tr></tbody><tbody><tr><td>DoorClosed</td><td>‚ü∂</td><td>Open</td><td>‚ü∂</td><td>DoorOpen</td></tr></tbody><tbody><tr><td>DoorClosed</td><td>‚ü∂</td><td>Lock</td><td>‚ü∂</td><td>DoorLocked</td></tr></tbody><tbody><tr><td>DoorLocked</td><td>‚ü∂</td><td>Unlock ? PinIncorrect</td><td>‚ü∂</td><td>DoorLocked</td></tr></tbody><tbody><tr><td>DoorLocked</td><td>‚ü∂</td><td>Unlock ? PinCorrect</td><td>‚ü∂</td><td>DoorClosed</td></tr></tbody></table><!-- PD_END -->

The PureScript types now include data in both states and messages:

<!-- PD_START:purs
filePath: test/Examples/DoorWithPin.purs
pick:
  - State
  - Msg
-->

```purescript
data State
  = DoorOpen
  | DoorClosed
  | DoorLocked { pin :: String }

data Msg
  = Close
  | Open
  | Lock { newPin :: String }
  | Unlock { enteredPin :: String }
```

<p align="right"><sup>üóé <a href="test/Examples/DoorWithPin.purs#L24-L33">test/Examples/DoorWithPin.purs L24-L33</a></sup></p>
<!-- PD_END -->
